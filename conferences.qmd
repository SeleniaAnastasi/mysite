```{r}
#| echo: false
#| message: false
#| warning: false

library(leaflet)
library(magrittr)

# Carichiamo il database
conferenze <- read.csv("conferenze_db.csv", stringsAsFactors = FALSE)

# FORZIAMO LE COORDINATE A NUMERI (Risolve l'errore "numeric longitude values")
conferenze$lat <- as.numeric(conferenze$lat)
conferenze$lng <- as.numeric(conferenze$lng)

# Rimuoviamo righe che potrebbero avere coordinate mancanti dopo la conversione
conferenze <- conferenze[!is.na(conferenze$lat) & !is.na(conferenze$lng), ]

# Palette colori
pal <- colorFactor(palette = "Set1", domain = conferenze$type)

leaflet(conferenze) %>%
  addTiles() %>%
  addCircleMarkers(
    ~lng, ~lat, 
    popup = ~paste0("<b>", event_name, "</b><br>", 
                   name, " - ", city, "<br>",
                   "<i>", type, "</i>"),
    color = ~pal(type),
    fillOpacity = 0.8,
    radius = 8
  ) %>%
  addLegend(pal = pal, values = ~type, title = "Event Type", position = "bottomright")
```
### Lista delle Conferenze

```{r}
#| echo: false
knitr::kable(conferenze[, c("event_name","name", "city", "type")], col.names = c("Event", "Venue", "City", "Type"))
```