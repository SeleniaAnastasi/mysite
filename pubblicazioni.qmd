---
title: "Publications and network"
format:
  html:
    embed-resources: true
---

```{r}
#| echo: false
#| message: false
#| warning: false

library(tidyverse)
library(visNetwork)
library(knitr)

pubs <- read.csv("pubblicazioni_db.csv", stringsAsFactors = FALSE)

library(widyr)
edges <- pubs %>%
  separate_rows(authors, sep = ",\\s*") %>%
  pairwise_count(authors, title, upper = FALSE) %>%
  rename(from = item1, to = item2, value = n)

nodes <- data.frame(id = unique(c(edges$from, edges$to))) %>%
  mutate(
    label = id,
    shape = "dot",
    group = ifelse(id == "Anastasi S.", "Me", "Co-author"),
    value = 10 
  )

visNetwork(nodes, edges) %>%
  visGroups(groupname = "Me", color = "#FF4136", size = 30) %>%
  visGroups(groupname = "Co-author", color = "#0074D9") %>%
  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%
  visPhysics(solver = "forceAtlas2Based", forceAtlas2Based = list(gravitationalConstant = -50)) %>%
  visLayout(randomSeed = 123)
```
#| echo: false
#| results: asis

### Lista delle Conferenze

```r
### Peer-reviewed Publications

```{r}
#| echo: false
#| results: asis

pubs %>%
  arrange(desc(year)) %>%
  mutate(Entry = paste0("**", title, "** (", year, "). In: *", authors, "* [", type, "]")) %>%
  select(Entry) %>%
  kable(col.names = NULL)
```